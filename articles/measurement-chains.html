<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="kwb.geosalz">
<title>Measurement Chains • kwb.geosalz</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Measurement Chains">
<meta property="og:description" content="kwb.geosalz">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">kwb.geosalz</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.5.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/data-availability_fri.html">Data Availability Waterworks Friedrichshagen</a>
    <a class="dropdown-item" href="../articles/emshoff91.html">Emshoff 91</a>
    <a class="dropdown-item" href="../articles/hydrochemistry.html">Hydrochemistry</a>
    <a class="dropdown-item" href="../articles/measurement-chains.html">Measurement Chains</a>
    <a class="dropdown-item" href="../articles/wasserportal.html">Wasserportal</a>
    <a class="dropdown-item" href="../articles/workflow.html">Workflow</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/KWB-R/kwb.geosalz/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="measurement-chains_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="measurement-chains_files/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="measurement-chains_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="measurement-chains_files/datatables-binding-0.25/datatables.js"></script><link href="measurement-chains_files/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="measurement-chains_files/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="measurement-chains_files/dt-core-1.11.3/js/jquery.dataTables.min.js"></script><link href="measurement-chains_files/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="measurement-chains_files/crosstalk-1.2.0/js/crosstalk.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Measurement Chains</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/KWB-R/kwb.geosalz/blob/HEAD/vignettes/measurement-chains.Rmd" class="external-link"><code>vignettes/measurement-chains.Rmd</code></a></small>
      <div class="d-none name"><code>measurement-chains.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>One measurement chain consist of six sensors (column <code>sensor_endnummer</code> in <code>Table 1</code>), which will be placed into one production well, but at different filter depths. In total three measurement chains will be installed into three different production wells (column: <code>brunnen_nummer</code> in <code>Table 1</code>) as shown in detail in <code>Table 1</code> below:</p>
<div id="htmlwidget-2e516e3e6b5d18f2ad73" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-2e516e3e6b5d18f2ad73">{"x":{"filter":"none","vertical":false,"caption":"<caption>Table 1: Metadata of Measurement Chains<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18"],["K","K","K","K","K","K","K","K","K","K","K","K","K","K","K","K","K","K"],[9,9,9,9,9,9,10,10,10,10,10,10,11,11,11,11,11,11],[400,400,400,400,400,400,600,600,600,600,600,600,600,600,600,600,600,600],["über Filter","über Filter","über Filter","über Filter","über Filter","über Filter","unter Filter","unter Filter","unter Filter","unter Filter","unter Filter","unter Filter","unter Filter","unter Filter","unter Filter","unter Filter","unter Filter","unter Filter"],["unter Pumpe","unter Pumpe","unter Pumpe","unter Pumpe","unter Pumpe","unter Pumpe","über Pumpe (am Steigrohr)","über Pumpe (am Steigrohr)","über Pumpe (am Steigrohr)","über Pumpe (am Steigrohr)","über Pumpe (am Steigrohr)","über Pumpe (am Steigrohr)","über Pumpe (am Steigrohr)","über Pumpe (am Steigrohr)","über Pumpe (am Steigrohr)","über Pumpe (am Steigrohr)","über Pumpe (am Steigrohr)","über Pumpe (am Steigrohr)"],[21,21,21,21,21,21,11,11,11,11,11,11,12,12,12,12,12,12],[27,27,27,27,27,27,18,18,18,18,18,18,20,20,20,20,20,20],[null,null,null,null,null,null,4182006,4182005,4182004,4182003,4182002,4182001,null,null,null,null,null,null],[6,5,4,3,2,1,6,5,4,3,2,1,6,5,4,3,2,1],[21.5,22.5,23.5,24.5,25.5,26.5,11.5,12.7,13.9,15.1,16.3,17.5,12.5,13.9,15.3,16.7,18.1,19.5]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>galerie<\/th>\n      <th>brunnen_nummer<\/th>\n      <th>dn<\/th>\n      <th>einbau_pumpe<\/th>\n      <th>einbau_messkette<\/th>\n      <th>filteroberkante_muGOK<\/th>\n      <th>filterunterkante_muGOK<\/th>\n      <th>sensor_id<\/th>\n      <th>sensor_endnummer<\/th>\n      <th>einbau_sensor_muGOK<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,6,7,8,9,10]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p>Each sensor (type: <code>WLF05</code>, <code>link_to_manufacturer_factsheet</code>: <code>to_do: add-link-to-factsheet-on-kwb-cloud</code>) measures the the following two parameters with the characteristics summarized below:</p>
<ul>
<li><p><code>electrical conductivity</code>:</p></li>
<li><p>measurement range: <code>0 - 20 mS</code></p></li>
<li><p>measurement range detection: <code>automatic</code></p></li>
<li><p>typical accuracy: +/- 1.5 % of measurement value</p></li>
<li><p><code>temperature</code>:</p></li>
<li><p>measurement range: <code>0 - 50 Celsius</code></p></li>
<li><p>measurement resolution: <code>0.1 Celsius</code></p></li>
<li><p>typical accuracy: <code>&lt;= 0.1 Celsius</code></p></li>
</ul>
<p>The maximum <code>temporal resolution</code> of each sensor is <code>every second</code>. Within the project <code>GeoSalz</code> a measurement <code>every 5 minutes</code> is proposed by KWB in order to be able to detect potential salinity shifts due to a switched pumping regime.</p>
</div>
<div class="section level2">
<h2 id="data-management">Data Management<a class="anchor" aria-label="anchor" href="#data-management"></a>
</h2>
<div class="section level3">
<h3 id="define-sftp-login">Define SFTP Login<a class="anchor" aria-label="anchor" href="#define-sftp-login"></a>
</h3>
<p>Run <code><a href="https://usethis.r-lib.org/reference/edit.html" class="external-link">usethis::edit_r_environ()</a></code> to edit the R <code>.Renviron</code> file and add the following three environment variables.</p>
<pre><code>MESSKETTEN_SERVER = &lt;sftp_url&gt;
MESSKETTEN_USER = &lt;sftp_username&gt;
MESSKETTEN_PASSWORD = &lt;sftp_userpassord&gt;</code></pre>
<p>Finally save the <code>.Renviron</code> file and restart <code>R(Studio)</code>. Subsequently the code below will work (in case the SFTP login credentials were defined correctly!) and assure that the <code>measurement chains</code> data (i.e. parameters <code>electrical conductivity</code> and <code>temperature</code>) will be downloaded from the <code>SFTP server</code> to a user-defined directory on your local device. For auto</p>
</div>
<div class="section level3">
<h3 id="data-download">Data Download<a class="anchor" aria-label="anchor" href="#data-download"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/KWB-R/kwb.geosalz" class="external-link">kwb.geosalz</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">### Metadata of measurement chains (see also Table 1 above)</span></span>
<span><span class="va">mc_metadata</span> <span class="op">&lt;-</span> <span class="fu">kwb.geosalz</span><span class="fu">::</span><span class="fu"><a href="../reference/get_measurementchains_metadata.html">get_measurementchains_metadata</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">mc_metadata</span><span class="op">)</span></span>
<span><span class="co">#&gt; spec_tbl_df [18 × 10] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ galerie               : chr [1:18] "K" "K" "K" "K" ...</span></span>
<span><span class="co">#&gt;  $ brunnen_nummer        : int [1:18] 9 9 9 9 9 9 10 10 10 10 ...</span></span>
<span><span class="co">#&gt;  $ dn                    : int [1:18] 400 400 400 400 400 400 600 600 600 600 ...</span></span>
<span><span class="co">#&gt;  $ einbau_pumpe          : chr [1:18] "über Filter" "über Filter" "über Filter" "über Filter" ...</span></span>
<span><span class="co">#&gt;  $ einbau_messkette      : chr [1:18] "unter Pumpe" "unter Pumpe" "unter Pumpe" "unter Pumpe" ...</span></span>
<span><span class="co">#&gt;  $ filteroberkante_muGOK : num [1:18] 21 21 21 21 21 21 11 11 11 11 ...</span></span>
<span><span class="co">#&gt;  $ filterunterkante_muGOK: num [1:18] 27 27 27 27 27 27 18 18 18 18 ...</span></span>
<span><span class="co">#&gt;  $ sensor_id             : int [1:18] NA NA NA NA NA NA 4182006 4182005 4182004 4182003 ...</span></span>
<span><span class="co">#&gt;  $ sensor_endnummer      : int [1:18] 6 5 4 3 2 1 6 5 4 3 ...</span></span>
<span><span class="co">#&gt;  $ einbau_sensor_muGOK   : num [1:18] 21.5 22.5 23.5 24.5 25.5 26.5 11.5 12.7 13.9 15.1 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "spec")=</span></span>
<span><span class="co">#&gt;   .. cols(</span></span>
<span><span class="co">#&gt;   ..   galerie = <span style="color: #BB0000;">col_character()</span>,</span></span>
<span><span class="co">#&gt;   ..   brunnen_nummer = <span style="color: #00BB00;">col_integer()</span>,</span></span>
<span><span class="co">#&gt;   ..   dn = <span style="color: #00BB00;">col_integer()</span>,</span></span>
<span><span class="co">#&gt;   ..   einbau_pumpe = <span style="color: #BB0000;">col_character()</span>,</span></span>
<span><span class="co">#&gt;   ..   einbau_messkette = <span style="color: #BB0000;">col_character()</span>,</span></span>
<span><span class="co">#&gt;   ..   filteroberkante_muGOK = <span style="color: #00BB00;">col_double()</span>,</span></span>
<span><span class="co">#&gt;   ..   filterunterkante_muGOK = <span style="color: #00BB00;">col_double()</span>,</span></span>
<span><span class="co">#&gt;   ..   sensor_id = <span style="color: #00BB00;">col_integer()</span>,</span></span>
<span><span class="co">#&gt;   ..   sensor_endnummer = <span style="color: #00BB00;">col_integer()</span>,</span></span>
<span><span class="co">#&gt;   ..   einbau_sensor_muGOK = <span style="color: #00BB00;">col_double()</span></span></span>
<span><span class="co">#&gt;   .. )</span></span>
<span><span class="co">#&gt;  - attr(*, "problems")=&lt;externalptr&gt;</span></span>
<span></span>
<span><span class="co">### Tibble with Information on available measurement chain files on SFTP server</span></span>
<span><span class="va">mc_files</span> <span class="op">&lt;-</span> <span class="fu">kwb.geosalz</span><span class="fu">::</span><span class="fu"><a href="../reference/get_measurementchains_files.html">get_measurementchains_files</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">mc_files</span><span class="op">)</span></span>
<span><span class="co">#&gt; tibble [366 × 15] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ rights          : chr [1:366] "-rw-r--r--" "-rw-r--r--" "-rw-r--r--" "-rw-r--r--" ...</span></span>
<span><span class="co">#&gt;  $ links           : chr [1:366] "1" "1" "1" "1" ...</span></span>
<span><span class="co">#&gt;  $ ownername       : chr [1:366] "1011" "1011" "1011" "1011" ...</span></span>
<span><span class="co">#&gt;  $ ownergroup      : chr [1:366] "1002" "1002" "1002" "1002" ...</span></span>
<span><span class="co">#&gt;  $ filesize        : chr [1:366] "235" "235" "238" "239" ...</span></span>
<span><span class="co">#&gt;  $ t1              : chr [1:366] "Jul" "Jul" "Jul" "Jul" ...</span></span>
<span><span class="co">#&gt;  $ t2              : chr [1:366] "8" "9" "10" "11" ...</span></span>
<span><span class="co">#&gt;  $ t3              : chr [1:366] "09:20" "06:00" "06:00" "06:00" ...</span></span>
<span><span class="co">#&gt;  $ sftp_path       : chr [1:366] "K10/4182001-2022-07-08-0506.csv" "K10/4182001-2022-07-09-0506.csv" "K10/4182001-2022-07-10-0507.csv" "K10/4182001-2022-07-11-0507.csv" ...</span></span>
<span><span class="co">#&gt;  $ sensor_id       : int [1:366] 4182001 4182001 4182001 4182001 4182001 4182001 4182001 4182001 4182001 4182001 ...</span></span>
<span><span class="co">#&gt;  $ datum_uhrzeit   : POSIXct[1:366], format: "2022-07-08 05:06:00" "2022-07-09 05:06:00" ...</span></span>
<span><span class="co">#&gt;  $ type            : chr [1:366] "file" "file" "file" "file" ...</span></span>
<span><span class="co">#&gt;  $ galerie         : chr [1:366] "K" "K" "K" "K" ...</span></span>
<span><span class="co">#&gt;  $ brunnen_nummer  : int [1:366] 10 10 10 10 10 10 10 10 10 10 ...</span></span>
<span><span class="co">#&gt;  $ sensor_endnummer: int [1:366] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mc_files</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 15</span></span></span>
<span><span class="co">#&gt;   rights     links ownername ownergr…¹ files…² t1    t2    t3    sftp_…³ senso…⁴</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> -rw-r--r-- 1     1011      1002      235     Jul   8     09:20 K10/41… 4<span style="text-decoration: underline;">182</span>001</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> -rw-r--r-- 1     1011      1002      235     Jul   9     06:00 K10/41… 4<span style="text-decoration: underline;">182</span>001</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> -rw-r--r-- 1     1011      1002      238     Jul   10    06:00 K10/41… 4<span style="text-decoration: underline;">182</span>001</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> -rw-r--r-- 1     1011      1002      239     Jul   11    06:00 K10/41… 4<span style="text-decoration: underline;">182</span>001</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> -rw-r--r-- 1     1011      1002      239     Jul   12    06:00 K10/41… 4<span style="text-decoration: underline;">182</span>001</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> -rw-r--r-- 1     1011      1002      239     Jul   13    06:00 K10/41… 4<span style="text-decoration: underline;">182</span>001</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 5 more variables: datum_uhrzeit &lt;dttm&gt;, type &lt;chr&gt;, galerie &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   brunnen_nummer &lt;int&gt;, sensor_endnummer &lt;int&gt;, and abbreviated variable</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   names ¹​ownergroup, ²​filesize, ³​sftp_path, ⁴​sensor_id</span></span></span>
<span></span>
<span><span class="co"># Define target directory for download of measurement chain `.csv` files</span></span>
<span><span class="va">target_directory</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Download of measurement mhain `.csv` files from SFTP server</span></span>
<span><span class="va">csv_files</span> <span class="op">&lt;-</span> <span class="fu">kwb.geosalz</span><span class="fu">::</span><span class="fu"><a href="../reference/download_measurementchains_data.html">download_measurementchains_data</a></span><span class="op">(</span></span>
<span>  sftp_paths <span class="op">=</span> <span class="va">mc_files</span><span class="op">$</span><span class="va">sftp_path</span>,</span>
<span>  <span class="va">target_directory</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Download 366 measurement chains files (using 2 CPU cores) ... ok. (12.37s)</span></span>
<span></span>
<span><span class="va">csv_files</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 366 × 3</span></span></span>
<span><span class="co">#&gt;    file_id sftp_path                       local_path                           </span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>       1 K10/4182001-2022-07-08-0506.csv C:/Users/RUNNER~1/AppData/Local/Temp…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>       2 K10/4182001-2022-07-09-0506.csv C:/Users/RUNNER~1/AppData/Local/Temp…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>       3 K10/4182001-2022-07-10-0507.csv C:/Users/RUNNER~1/AppData/Local/Temp…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>       4 K10/4182001-2022-07-11-0507.csv C:/Users/RUNNER~1/AppData/Local/Temp…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>       5 K10/4182001-2022-07-12-0506.csv C:/Users/RUNNER~1/AppData/Local/Temp…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>       6 K10/4182001-2022-07-13-0506.csv C:/Users/RUNNER~1/AppData/Local/Temp…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>       7 K10/4182001-2022-07-14-0506.csv C:/Users/RUNNER~1/AppData/Local/Temp…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>       8 K10/4182001-2022-07-15-0507.csv C:/Users/RUNNER~1/AppData/Local/Temp…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>       9 K10/4182001-2022-07-16-0507.csv C:/Users/RUNNER~1/AppData/Local/Temp…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>      10 K10/4182001-2022-07-17-0507.csv C:/Users/RUNNER~1/AppData/Local/Temp…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 356 more rows</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-import">Data Import<a class="anchor" aria-label="anchor" href="#data-import"></a>
</h3>
<p>The downloaded <code>.csv</code> measurement chains files will be imported into R by running the code below:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### print error in case no csv file is available</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">csv_files</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0L</span><span class="op">)</span> </span>
<span></span>
<span><span class="co">### CSV import using single CPU core</span></span>
<span><span class="va">mc_data_single</span> <span class="op">&lt;-</span> <span class="fu">kwb.geosalz</span><span class="fu">::</span><span class="fu"><a href="../reference/read_measurementchains_data.html">read_measurementchains_data</a></span><span class="op">(</span></span>
<span>  <span class="va">csv_files</span>,</span>
<span>  run_parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Importing 366 measurement chains files (using 1 CPU core) ... ok. (7.96s)</span></span>
<span></span>
<span><span class="co">## CSV import using multiple CPU cores</span></span>
<span><span class="va">mc_data_parallel</span> <span class="op">&lt;-</span> <span class="fu">kwb.geosalz</span><span class="fu">::</span><span class="fu"><a href="../reference/read_measurementchains_data.html">read_measurementchains_data</a></span><span class="op">(</span></span>
<span>  <span class="va">csv_files</span>,</span>
<span>  run_parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Importing 366 measurement chains files (using 2 CPU cores) ... ok. (6.09s)</span></span>
<span></span>
<span><span class="co">### Just test if both imports give identical results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">mc_data_single</span>, <span class="va">mc_data_parallel</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="va">mc_data_parallel</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,928 × 5</span></span></span>
<span><span class="co">#&gt;    file_id sensor_id datum_uhrzeit       parameter      messwert</span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>       1   4<span style="text-decoration: underline;">182</span>001 2022-07-07 <span style="color: #949494;">05:00:00</span> Leitfaehigkeit      971</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>       1   4<span style="text-decoration: underline;">182</span>001 2022-07-07 <span style="color: #949494;">11:00:00</span> Leitfaehigkeit      974</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>       1   4<span style="text-decoration: underline;">182</span>001 2022-07-07 <span style="color: #949494;">17:00:00</span> Leitfaehigkeit      982</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>       1   4<span style="text-decoration: underline;">182</span>001 2022-07-07 <span style="color: #949494;">23:00:00</span> Leitfaehigkeit      983</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>       2   4<span style="text-decoration: underline;">182</span>001 2022-07-08 <span style="color: #949494;">05:00:00</span> Leitfaehigkeit      982</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>       2   4<span style="text-decoration: underline;">182</span>001 2022-07-08 <span style="color: #949494;">11:00:00</span> Leitfaehigkeit      985</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>       2   4<span style="text-decoration: underline;">182</span>001 2022-07-08 <span style="color: #949494;">17:00:00</span> Leitfaehigkeit      994</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>       2   4<span style="text-decoration: underline;">182</span>001 2022-07-08 <span style="color: #949494;">23:00:00</span> Leitfaehigkeit      995</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>       3   4<span style="text-decoration: underline;">182</span>001 2022-07-09 <span style="color: #949494;">05:00:00</span> Leitfaehigkeit      996</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>       3   4<span style="text-decoration: underline;">182</span>001 2022-07-09 <span style="color: #949494;">11:00:00</span> Leitfaehigkeit     <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 2,918 more rows</span></span></span></code></pre></div>
<p>In a nutshell the following datasets were imported into R:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mc_data_parallel_stats</span> <span class="op">&lt;-</span> <span class="va">mc_data_parallel</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>  </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span></span>
<span>    <span class="va">.data</span><span class="op">$</span><span class="va">sensor_id</span>,</span>
<span>    <span class="va">.data</span><span class="op">$</span><span class="va">parameter</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    datetime_min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">datum_uhrzeit</span><span class="op">)</span>, </span>
<span>    datetime_max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">datum_uhrzeit</span><span class="op">)</span>,</span>
<span>    number_of_samples <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span></span>
<span>    <span class="va">.data</span><span class="op">$</span><span class="va">sensor_id</span>, </span>
<span>    <span class="va">.data</span><span class="op">$</span><span class="va">parameter</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'sensor_id'. You can override using the</span></span>
<span><span class="co">#&gt; `.groups` argument.</span></span>
<span></span>
<span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="va">mc_data_parallel_stats</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-f2070d545657b32c1f2f" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-f2070d545657b32c1f2f">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12"],[4182001,4182001,4182002,4182002,4182003,4182003,4182004,4182004,4182005,4182005,4182006,4182006],["Leitfaehigkeit","Temperatur","Leitfaehigkeit","Temperatur","Leitfaehigkeit","Temperatur","Leitfaehigkeit","Temperatur","Leitfaehigkeit","Temperatur","Leitfaehigkeit","Temperatur"],["2022-07-07T04:00:00Z","2022-07-07T04:00:00Z","2022-07-07T04:00:00Z","2022-07-07T04:00:00Z","2022-07-07T04:00:00Z","2022-07-07T04:00:00Z","2022-07-07T04:00:00Z","2022-07-07T04:00:00Z","2022-07-07T04:00:00Z","2022-07-07T04:00:00Z","2022-07-07T04:00:00Z","2022-07-07T04:00:00Z"],["2022-09-05T22:00:00Z","2022-09-05T22:00:00Z","2022-09-05T22:00:00Z","2022-09-05T22:00:00Z","2022-09-05T22:00:00Z","2022-09-05T22:00:00Z","2022-09-05T22:00:00Z","2022-09-05T22:00:00Z","2022-09-05T22:00:00Z","2022-09-05T22:00:00Z","2022-09-05T22:00:00Z","2022-09-05T22:00:00Z"],[244,244,244,244,244,244,244,244,244,244,244,244]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>sensor_id<\/th>\n      <th>parameter<\/th>\n      <th>datetime_min<\/th>\n      <th>datetime_max<\/th>\n      <th>number_of_samples<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p>These cover the time period from 2022-07-07 05:00:00 to 2022-07-07 05:00:00 with a total of 2928 samples.</p>
</div>
<div class="section level3">
<h3 id="data-export">Data Export<a class="anchor" aria-label="anchor" href="#data-export"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">debug</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span></span>
<span><span class="co">### Export to csv file</span></span>
<span><span class="va">csv_path</span> <span class="op">&lt;-</span> <span class="fu">kwb.geosalz</span><span class="fu">::</span><span class="fu"><a href="../reference/write_measurementchains_data.html">write_measurementchains_data</a></span><span class="op">(</span></span>
<span>  <span class="va">mc_data_parallel</span>,</span>
<span>  <span class="va">target_directory</span>,</span>
<span>  to_zip <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  debug <span class="op">=</span> <span class="va">debug</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Exporting provided dataset 'mc_data_parallel' to 'C:/Users/RUNNER~1/AppData/Local/Temp/Rtmpcd3yco/mc-data_20220707-050000TZ+01_20220905-230000TZ+01.csv' ... ok. (0.09s)</span></span>
<span></span>
<span><span class="va">size_csv</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/file_info.html" class="external-link">file_size</a></span><span class="op">(</span><span class="va">csv_path</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### Export to zip file (~10x less disk space for test dataset)</span></span>
<span><span class="va">zip_path</span> <span class="op">&lt;-</span> <span class="fu">kwb.geosalz</span><span class="fu">::</span><span class="fu"><a href="../reference/write_measurementchains_data.html">write_measurementchains_data</a></span><span class="op">(</span></span>
<span>  <span class="va">mc_data_parallel</span>,</span>
<span>  <span class="va">target_directory</span>,</span>
<span>  to_zip <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  debug <span class="op">=</span> <span class="va">debug</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Exporting provided dataset 'mc_data_parallel' to 'C:/Users/RUNNER~1/AppData/Local/Temp/Rtmpcd3yco/mc-data_20220707-050000TZ+01_20220905-230000TZ+01.csv' ... ok. (0.10s) </span></span>
<span><span class="co">#&gt; Exporting provided dataset 'mc_data_parallel' to 'C:/Users/RUNNER~1/AppData/Local/Temp/Rtmpcd3yco/mc-data_20220707-050000TZ+01_20220905-230000TZ+01.zip' and delete intermediate 'C:/Users/RUNNER~1/AppData/Local/Temp/Rtmpcd3yco/mc-data_20220707-050000TZ+01_20220905-230000TZ+01.csv' ... ok. (0.01s)</span></span>
<span></span>
<span><span class="va">size_zip</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/file_info.html" class="external-link">file_size</a></span><span class="op">(</span><span class="va">zip_path</span><span class="op">)</span></span>
<span></span>
<span><span class="va">size_csv</span> <span class="op">/</span> <span class="va">size_zip</span></span>
<span><span class="co">#&gt; 10.4</span></span></code></pre></div>
<p>The file size of the mc-data_20220707-050000TZ+01_20220905-230000TZ+01.csv file is 10.4 times larger compared to compressing it into <code>r</code>basename(zip_path)`.</p>
</div>
<div class="section level3">
<h3 id="data-upload">Data Upload<a class="anchor" aria-label="anchor" href="#data-upload"></a>
</h3>
<p>In order to automate the data management process the <a href="#data-export">exported data</a> it is planned to upload these data to a restricted shared folder on the KWB cloud.</p>
<pre><code>to do: implement functions in R package</code></pre>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://mrustl.de" class="external-link">Michael Rustler</a>, <a href="https://www.kompetenz-wasser.de/en/forschung/projekte/geosalz" class="external-link"><img src="https://www.kompetenz-wasser.de/media/pages/forschung/projekte/geosalz/7bc1cad2b3-1650461797/geosalz_logo_transparent_rgb.png" alt="Project GeoSalz" height="24"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
