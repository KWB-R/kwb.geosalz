<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="kwb.geosalz">
<title>Measurement Chains • kwb.geosalz</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Measurement Chains">
<meta property="og:description" content="kwb.geosalz">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">kwb.geosalz</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.5.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/data-availability_fri.html">Data Availability Waterworks Friedrichshagen</a>
    <a class="dropdown-item" href="../articles/emshoff91.html">Emshoff 91</a>
    <a class="dropdown-item" href="../articles/hydrochemistry.html">Hydrochemistry</a>
    <a class="dropdown-item" href="../articles/measurement-chains.html">Measurement Chains</a>
    <a class="dropdown-item" href="../articles/wasserportal.html">Wasserportal</a>
    <a class="dropdown-item" href="../articles/workflow.html">Workflow</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/KWB-R/kwb.geosalz/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="measurement-chains_files/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="measurement-chains_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="measurement-chains_files/datatables-binding-0.26/datatables.js"></script><link href="measurement-chains_files/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="measurement-chains_files/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="measurement-chains_files/dt-core-1.12.1/js/jquery.dataTables.min.js"></script><link href="measurement-chains_files/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="measurement-chains_files/crosstalk-1.2.0/js/crosstalk.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Measurement Chains</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/KWB-R/kwb.geosalz/blob/HEAD/vignettes/measurement-chains.Rmd" class="external-link"><code>vignettes/measurement-chains.Rmd</code></a></small>
      <div class="d-none name"><code>measurement-chains.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>One measurement chain consist of six sensors (column
<code>sensor_endnummer</code> in <code>Table 1</code>), which will be
placed into one production well, but at different filter depths. In
total three measurement chains will be installed into three different
production wells (column: <code>brunnen_nummer</code> in
<code>Table 1</code>) as shown in detail in <code>Table 1</code>
below:</p>
<div id="htmlwidget-afb00caee0094e81a26e" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-afb00caee0094e81a26e">{"x":{"filter":"none","vertical":false,"caption":"<caption>Table 1: Metadata of Measurement Chains<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18"],["K","K","K","K","K","K","K","K","K","K","K","K","K","K","K","K","K","K"],[9,9,9,9,9,9,10,10,10,10,10,10,13,13,13,13,13,13],[400,400,400,400,400,400,600,600,600,600,600,600,600,600,600,600,600,600],["über Filter","über Filter","über Filter","über Filter","über Filter","über Filter","unter Filter","unter Filter","unter Filter","unter Filter","unter Filter","unter Filter","unter Filter","unter Filter","unter Filter","unter Filter","unter Filter","unter Filter"],["unter Pumpe","unter Pumpe","unter Pumpe","unter Pumpe","unter Pumpe","unter Pumpe","über Pumpe (am Steigrohr)","über Pumpe (am Steigrohr)","über Pumpe (am Steigrohr)","über Pumpe (am Steigrohr)","über Pumpe (am Steigrohr)","über Pumpe (am Steigrohr)","über Pumpe (am Steigrohr)","über Pumpe (am Steigrohr)","über Pumpe (am Steigrohr)","über Pumpe (am Steigrohr)","über Pumpe (am Steigrohr)","über Pumpe (am Steigrohr)"],[21,21,21,21,21,21,11,11,11,11,11,11,12,12,12,12,12,12],[27,27,27,27,27,27,18,18,18,18,18,18,20,20,20,20,20,20],[4182018,4182017,4182016,4182015,4182014,4182013,4182006,4182005,4182004,4182003,4182002,4182001,4182012,4182011,4182010,4182009,4182008,4182007],[8,7,6,5,4,3,6,5,4,3,2,1,2,1,0,9,8,7],[21.5,22.5,23.5,24.5,25.5,26.5,11.5,12.7,13.9,15.1,16.3,17.5,12.5,13.9,15.3,16.7,18.1,19.5]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>galerie<\/th>\n      <th>brunnen_nummer<\/th>\n      <th>dn<\/th>\n      <th>einbau_pumpe<\/th>\n      <th>einbau_messkette<\/th>\n      <th>filteroberkante_muGOK<\/th>\n      <th>filterunterkante_muGOK<\/th>\n      <th>sensor_id<\/th>\n      <th>sensor_endnummer<\/th>\n      <th>einbau_sensor_muGOK<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,6,7,8,9,10]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p>Each sensor (type: <code>WLF05</code>,
<code>link_to_manufacturer_factsheet</code>:
<code>to_do: add-link-to-factsheet-on-kwb-cloud</code>) measures the the
following two parameters with the characteristics summarized below:</p>
<ul>
<li><p><code>electrical conductivity</code>:</p></li>
<li><p>measurement range: <code>0 - 20 mS</code></p></li>
<li><p>measurement range detection: <code>automatic</code></p></li>
<li><p>typical accuracy: +/- 1.5 % of measurement value</p></li>
<li><p><code>temperature</code>:</p></li>
<li><p>measurement range: <code>0 - 50 \u00B0 Celsius</code></p></li>
<li><p>measurement resolution: <code>0.1 \u00B0 Celsius</code></p></li>
<li><p>typical accuracy: <code>&lt;= 0.1 \u00B0 Celsius</code></p></li>
</ul>
<p>The maximum <code>temporal resolution</code> of each sensor is
<code>every second</code>. Within the project <code>GeoSalz</code> a
measurement <code>every 5 minutes</code> is proposed by KWB in order to
be able to detect potential salinity shifts due to a switched pumping
regime.</p>
</div>
<div class="section level2">
<h2 id="data-management">Data Management<a class="anchor" aria-label="anchor" href="#data-management"></a>
</h2>
<div class="section level3">
<h3 id="define-paths">Define Paths<a class="anchor" aria-label="anchor" href="#define-paths"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paths_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span> local_dir <span class="op">=</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/path_math.html" class="external-link">path_abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span> <span class="co"># Define target directory for download of measurement chain `.csv` files</span></span>
<span> download_dir <span class="op">=</span> <span class="st">"&lt;local_dir&gt;/download"</span>, </span>
<span> <span class="co"># Local directory for exporting imported data to ".csv" and ".zip" </span></span>
<span> export_dir <span class="op">=</span> <span class="st">"&lt;local_dir&gt;/export"</span>, </span>
<span> <span class="co"># Upload KWB cloud directory for imported data in "export_dir"</span></span>
<span> upload_dir <span class="op">=</span> <span class="st">"projects/GeoSalz/Monitoring/messketten"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">paths</span> <span class="op">&lt;-</span> <span class="fu">kwb.utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kwb.utils/man/resolve.html" class="external-link">resolve</a></span><span class="op">(</span><span class="va">paths_list</span><span class="op">)</span></span>
<span></span>
<span><span class="va">paths</span></span>
<span><span class="co">#&gt; $local_dir</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB; font-weight: bold;">C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $download_dir</span></span>
<span><span class="co">#&gt; [1] "C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/download"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $export_dir</span></span>
<span><span class="co">#&gt; [1] "C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upload_dir</span></span>
<span><span class="co">#&gt; [1] "projects/GeoSalz/Monitoring/messketten"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="define-sftp-login">Define SFTP Login<a class="anchor" aria-label="anchor" href="#define-sftp-login"></a>
</h3>
<p>Run <code><a href="https://usethis.r-lib.org/reference/edit.html" class="external-link">usethis::edit_r_environ()</a></code> to edit the R
<code>.Renviron</code> file and add the following three environment
variables.</p>
<pre><code>MESSKETTEN_SERVER = &lt;sftp_url&gt;
MESSKETTEN_USER = &lt;sftp_username&gt;
MESSKETTEN_PASSWORD = &lt;sftp_userpassword&gt;</code></pre>
<p>Finally save the <code>.Renviron</code> file and restart
<code>R(Studio)</code>. Subsequently the code below will work (in case
the SFTP login credentials were defined correctly!) and assure that the
<code>measurement chains</code> data (i.e. parameters
<code>electrical conductivity</code> and <code>temperature</code>) will
be downloaded from the <code>SFTP server</code> to a user-defined
directory on your local device.</p>
</div>
<div class="section level3">
<h3 id="data-download">Data Download<a class="anchor" aria-label="anchor" href="#data-download"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/KWB-R/kwb.geosalz" class="external-link">kwb.geosalz</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">### Metadata of measurement chains (see also Table 1 above)</span></span>
<span><span class="va">mc_metadata</span> <span class="op">&lt;-</span> <span class="fu">kwb.geosalz</span><span class="fu">::</span><span class="fu"><a href="../reference/get_measurementchains_metadata.html">get_measurementchains_metadata</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">mc_metadata</span><span class="op">)</span></span>
<span><span class="co">#&gt; spc_tbl_ [18 × 10] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ galerie               : chr [1:18] "K" "K" "K" "K" ...</span></span>
<span><span class="co">#&gt;  $ brunnen_nummer        : int [1:18] 9 9 9 9 9 9 10 10 10 10 ...</span></span>
<span><span class="co">#&gt;  $ dn                    : int [1:18] 400 400 400 400 400 400 600 600 600 600 ...</span></span>
<span><span class="co">#&gt;  $ einbau_pumpe          : chr [1:18] "über Filter" "über Filter" "über Filter" "über Filter" ...</span></span>
<span><span class="co">#&gt;  $ einbau_messkette      : chr [1:18] "unter Pumpe" "unter Pumpe" "unter Pumpe" "unter Pumpe" ...</span></span>
<span><span class="co">#&gt;  $ filteroberkante_muGOK : num [1:18] 21 21 21 21 21 21 11 11 11 11 ...</span></span>
<span><span class="co">#&gt;  $ filterunterkante_muGOK: num [1:18] 27 27 27 27 27 27 18 18 18 18 ...</span></span>
<span><span class="co">#&gt;  $ sensor_id             : int [1:18] 4182018 4182017 4182016 4182015 4182014 4182013 4182006 4182005 4182004 4182003 ...</span></span>
<span><span class="co">#&gt;  $ sensor_endnummer      : int [1:18] 8 7 6 5 4 3 6 5 4 3 ...</span></span>
<span><span class="co">#&gt;  $ einbau_sensor_muGOK   : num [1:18] 21.5 22.5 23.5 24.5 25.5 26.5 11.5 12.7 13.9 15.1 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "spec")=</span></span>
<span><span class="co">#&gt;   .. cols(</span></span>
<span><span class="co">#&gt;   ..   galerie = <span style="color: #BB0000;">col_character()</span>,</span></span>
<span><span class="co">#&gt;   ..   brunnen_nummer = <span style="color: #00BB00;">col_integer()</span>,</span></span>
<span><span class="co">#&gt;   ..   dn = <span style="color: #00BB00;">col_integer()</span>,</span></span>
<span><span class="co">#&gt;   ..   einbau_pumpe = <span style="color: #BB0000;">col_character()</span>,</span></span>
<span><span class="co">#&gt;   ..   einbau_messkette = <span style="color: #BB0000;">col_character()</span>,</span></span>
<span><span class="co">#&gt;   ..   filteroberkante_muGOK = <span style="color: #00BB00;">col_double()</span>,</span></span>
<span><span class="co">#&gt;   ..   filterunterkante_muGOK = <span style="color: #00BB00;">col_double()</span>,</span></span>
<span><span class="co">#&gt;   ..   sensor_id = <span style="color: #00BB00;">col_integer()</span>,</span></span>
<span><span class="co">#&gt;   ..   sensor_endnummer = <span style="color: #00BB00;">col_integer()</span>,</span></span>
<span><span class="co">#&gt;   ..   einbau_sensor_muGOK = <span style="color: #00BB00;">col_double()</span></span></span>
<span><span class="co">#&gt;   .. )</span></span>
<span><span class="co">#&gt;  - attr(*, "problems")=&lt;externalptr&gt;</span></span>
<span></span>
<span><span class="co">### Tibble with Information on available measurement chain files on SFTP server</span></span>
<span><span class="va">mc_files</span> <span class="op">&lt;-</span> <span class="fu">kwb.geosalz</span><span class="fu">::</span><span class="fu"><a href="../reference/get_measurementchains_files.html">get_measurementchains_files</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">mc_files</span><span class="op">)</span></span>
<span><span class="co">#&gt; tibble [979 × 15] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ rights          : chr [1:979] "-rw-r--r--" "-rw-r--r--" "-rw-r--r--" "-rw-r--r--" ...</span></span>
<span><span class="co">#&gt;  $ links           : chr [1:979] "1" "1" "1" "1" ...</span></span>
<span><span class="co">#&gt;  $ ownername       : chr [1:979] "1011" "1011" "1011" "1011" ...</span></span>
<span><span class="co">#&gt;  $ ownergroup      : chr [1:979] "1002" "1002" "1002" "1002" ...</span></span>
<span><span class="co">#&gt;  $ filesize        : chr [1:979] "4559" "4559" "4559" "4559" ...</span></span>
<span><span class="co">#&gt;  $ t1              : chr [1:979] "Oct" "Oct" "Oct" "Oct" ...</span></span>
<span><span class="co">#&gt;  $ t2              : chr [1:979] "24" "24" "24" "25" ...</span></span>
<span><span class="co">#&gt;  $ t3              : chr [1:979] "09:05" "09:05" "09:05" "06:15" ...</span></span>
<span><span class="co">#&gt;  $ sftp_path       : chr [1:979] "K09/4182013-2022-10-22-0606.csv" "K09/4182013-2022-10-23-0606.csv" "K09/4182013-2022-10-24-0606.csv" "K09/4182013-2022-10-25-0606.csv" ...</span></span>
<span><span class="co">#&gt;  $ sensor_id       : int [1:979] 4182013 4182013 4182013 4182013 4182013 4182013 4182013 4182013 4182013 4182013 ...</span></span>
<span><span class="co">#&gt;  $ datum_uhrzeit   : POSIXct[1:979], format: "2022-10-22 06:06:00" "2022-10-23 06:06:00" ...</span></span>
<span><span class="co">#&gt;  $ type            : chr [1:979] "file" "file" "file" "file" ...</span></span>
<span><span class="co">#&gt;  $ galerie         : chr [1:979] "K" "K" "K" "K" ...</span></span>
<span><span class="co">#&gt;  $ brunnen_nummer  : int [1:979] 9 9 9 9 9 9 9 9 9 9 ...</span></span>
<span><span class="co">#&gt;  $ sensor_endnummer: int [1:979] 3 3 3 3 3 3 3 3 3 3 ...</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mc_files</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 15</span></span></span>
<span><span class="co">#&gt;   rights     links ownername ownergr…¹ files…² t1    t2    t3    sftp_…³ senso…⁴</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> -rw-r--r-- 1     1011      1002      4559    Oct   24    09:05 K09/41… 4<span style="text-decoration: underline;">182</span>013</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> -rw-r--r-- 1     1011      1002      4559    Oct   24    09:05 K09/41… 4<span style="text-decoration: underline;">182</span>013</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> -rw-r--r-- 1     1011      1002      4559    Oct   24    09:05 K09/41… 4<span style="text-decoration: underline;">182</span>013</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> -rw-r--r-- 1     1011      1002      4559    Oct   25    06:15 K09/41… 4<span style="text-decoration: underline;">182</span>013</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> -rw-r--r-- 1     1011      1002      4559    Oct   26    06:15 K09/41… 4<span style="text-decoration: underline;">182</span>013</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> -rw-r--r-- 1     1011      1002      4559    Oct   27    06:15 K09/41… 4<span style="text-decoration: underline;">182</span>013</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 5 more variables: datum_uhrzeit &lt;dttm&gt;, type &lt;chr&gt;, galerie &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   brunnen_nummer &lt;int&gt;, sensor_endnummer &lt;int&gt;, and abbreviated variable</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   names ¹​ownergroup, ²​filesize, ³​sftp_path, ⁴​sensor_id</span></span></span>
<span></span>
<span><span class="co"># Download of measurement chain `.csv` files from SFTP server</span></span>
<span><span class="va">csv_files</span> <span class="op">&lt;-</span> <span class="fu">kwb.geosalz</span><span class="fu">::</span><span class="fu"><a href="../reference/download_measurementchains_data.html">download_measurementchains_data</a></span><span class="op">(</span></span>
<span>  sftp_paths <span class="op">=</span> <span class="va">mc_files</span><span class="op">$</span><span class="va">sftp_path</span>,</span>
<span>  target_directory <span class="op">=</span> <span class="va">paths</span><span class="op">$</span><span class="va">download_dir</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Download 979 measurement chains files (using 2 CPU cores) ... ok. (25.82s)</span></span>
<span></span>
<span><span class="va">csv_files</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 979 × 3</span></span></span>
<span><span class="co">#&gt;    file_id sftp_path                       local_path                           </span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>       1 K09/4182013-2022-10-22-0606.csv C:/Users/RUNNER~1/AppData/Local/Temp…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>       2 K09/4182013-2022-10-23-0606.csv C:/Users/RUNNER~1/AppData/Local/Temp…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>       3 K09/4182013-2022-10-24-0606.csv C:/Users/RUNNER~1/AppData/Local/Temp…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>       4 K09/4182013-2022-10-25-0606.csv C:/Users/RUNNER~1/AppData/Local/Temp…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>       5 K09/4182013-2022-10-26-0606.csv C:/Users/RUNNER~1/AppData/Local/Temp…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>       6 K09/4182013-2022-10-27-0606.csv C:/Users/RUNNER~1/AppData/Local/Temp…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>       7 K09/4182013-2022-10-28-0606.csv C:/Users/RUNNER~1/AppData/Local/Temp…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>       8 K09/4182013-2022-10-29-0606.csv C:/Users/RUNNER~1/AppData/Local/Temp…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>       9 K09/4182013-2022-10-30-0506.csv C:/Users/RUNNER~1/AppData/Local/Temp…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>      10 K09/4182013-2022-10-31-0506.csv C:/Users/RUNNER~1/AppData/Local/Temp…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 969 more rows</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-import">Data Import<a class="anchor" aria-label="anchor" href="#data-import"></a>
</h3>
<p>The downloaded <code>.csv</code> measurement chains files will be
imported into R by running the code below:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### print error in case no csv file is available</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">csv_files</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0L</span><span class="op">)</span> </span>
<span></span>
<span><span class="co">## CSV import using multiple CPU cores</span></span>
<span><span class="va">mc_data</span> <span class="op">&lt;-</span> <span class="fu">kwb.geosalz</span><span class="fu">::</span><span class="fu"><a href="../reference/read_measurementchains_data.html">read_measurementchains_data</a></span><span class="op">(</span></span>
<span>  <span class="va">csv_files</span>,</span>
<span>  run_parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Importing 979 measurement chains files (using 2 CPU cores) ... ok. (11.56s) </span></span>
<span><span class="co">#&gt; Filtering out 'lab' measurements before '2022-09-27 11:00:00' (installation in K10) ... ok. (0.01s)</span></span></code></pre></div>
<p>In a nutshell the following datasets were imported into R:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mc_data_stats</span> <span class="op">&lt;-</span> <span class="fu">kwb.geosalz</span><span class="fu">::</span><span class="fu"><a href="../reference/get_measurmentchains_data_stats.html">get_measurmentchains_data_stats</a></span><span class="op">(</span><span class="va">mc_data</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">parameter</span>, </span>
<span>                 <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">sensor_id</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>These cover the time period from 2022-09-27 11:00:00 to 2022-12-05
23:00:00 with a total of 91644 samples.</p>
</div>
<div class="section level3">
<h3 id="data-export">Data Export<a class="anchor" aria-label="anchor" href="#data-export"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">debug</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span></span>
<span><span class="co">### Export "mc_data" to csv file</span></span>
<span><span class="va">data_csv_path</span> <span class="op">&lt;-</span> <span class="fu">kwb.geosalz</span><span class="fu">::</span><span class="fu"><a href="../reference/write_measurementchains_data.html">write_measurementchains_data</a></span><span class="op">(</span></span>
<span>  <span class="va">mc_data</span>,</span>
<span>  target_directory <span class="op">=</span> <span class="va">paths</span><span class="op">$</span><span class="va">export_dir</span>,</span>
<span>  to_zip <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  debug <span class="op">=</span> <span class="va">debug</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Exporting provided dataset 'mc_data' to 'C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_data_20220927-110000TZ+01_20221205-230000TZ+01.csv' ... ok. (0.81s)</span></span>
<span></span>
<span><span class="va">size_data_csv</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/file_info.html" class="external-link">file_size</a></span><span class="op">(</span><span class="va">data_csv_path</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### Export "mc_data" to zip file (~10x less disk space for test dataset)</span></span>
<span><span class="va">data_zip_path</span> <span class="op">&lt;-</span> <span class="fu">kwb.geosalz</span><span class="fu">::</span><span class="fu"><a href="../reference/write_measurementchains_data.html">write_measurementchains_data</a></span><span class="op">(</span></span>
<span>  <span class="va">mc_data</span>,</span>
<span>  target_directory <span class="op">=</span> <span class="va">paths</span><span class="op">$</span><span class="va">export_dir</span>,</span>
<span>  to_zip <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  debug <span class="op">=</span> <span class="va">debug</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Exporting provided dataset 'mc_data' to 'C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_data_20220927-110000TZ+01_20221205-230000TZ+01.csv' ... ok. (0.81s) </span></span>
<span><span class="co">#&gt; Exporting provided dataset 'mc_data' to 'C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_data.zip' and delete intermediate 'C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_data_20220927-110000TZ+01_20221205-230000TZ+01.csv' ... ok. (0.07s)</span></span>
<span></span>
<span><span class="va">size_data_zip</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/file_info.html" class="external-link">file_size</a></span><span class="op">(</span><span class="va">data_zip_path</span><span class="op">)</span></span>
<span><span class="va">size_data_csv</span> <span class="op">/</span> <span class="va">size_data_zip</span></span>
<span><span class="co">#&gt; 17.8</span></span>
<span></span>
<span><span class="co">### Export "mc_files" and "mc_metadata" to csv</span></span>
<span><span class="va">extract_data_timeperiod</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data_path</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">data_path</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">kwb.utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kwb.utils/man/replaceFileExtension.html" class="external-link">replaceFileExtension</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>  </span>
<span>    <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html" class="external-link">str_remove</a></span><span class="op">(</span><span class="st">"^mc[-|_]data"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">write_csv</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">postfix</span> <span class="op">=</span> <span class="st">""</span>, <span class="va">target_directory</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/create.html" class="external-link">dir_create</a></span><span class="op">(</span><span class="va">target_directory</span><span class="op">)</span>  </span>
<span>  </span>
<span><span class="va">df_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/deparse.html" class="external-link">deparse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">substitute</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">target_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">target_directory</span>, </span>
<span>                         <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">df_name</span>, <span class="va">postfix</span>,  <span class="st">".csv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_csv</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">target_path</span><span class="op">)</span></span>
<span><span class="va">target_path</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">stats_path</span> <span class="op">&lt;-</span> <span class="fu">write_csv</span><span class="op">(</span><span class="va">mc_data_stats</span>,</span>
<span>                        postfix <span class="op">=</span> <span class="fu">extract_data_timeperiod</span><span class="op">(</span><span class="va">data_zip_path</span><span class="op">)</span>,</span>
<span>                        target_directory <span class="op">=</span> <span class="va">paths</span><span class="op">$</span><span class="va">export_dir</span><span class="op">)</span></span>
<span></span>
<span><span class="va">metadata_path</span> <span class="op">&lt;-</span> <span class="fu">write_csv</span><span class="op">(</span><span class="va">mc_metadata</span>, </span>
<span>                           postfix <span class="op">=</span> <span class="fu">extract_data_timeperiod</span><span class="op">(</span><span class="va">data_zip_path</span><span class="op">)</span>,</span>
<span>                           target_directory <span class="op">=</span> <span class="va">paths</span><span class="op">$</span><span class="va">export_dir</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">files_path</span> <span class="op">&lt;-</span> <span class="fu">write_csv</span><span class="op">(</span><span class="va">mc_files</span>, </span>
<span>                        postfix <span class="op">=</span> <span class="fu">extract_data_timeperiod</span><span class="op">(</span><span class="va">data_zip_path</span><span class="op">)</span>,</span>
<span>                        target_directory <span class="op">=</span> <span class="va">paths</span><span class="op">$</span><span class="va">export_dir</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_to_pdf</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mc_data</span>, <span class="va">para</span>, <span class="va">target_dir</span> <span class="op">=</span> <span class="st">"."</span>, <span class="va">debug</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span><span class="va">plts</span> <span class="op">&lt;-</span> <span class="fu">kwb.geosalz</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_measurementchains.html">plot_measurementchains</a></span><span class="op">(</span><span class="va">mc_data</span>, <span class="va">para</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">plts</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="op">{</span></span>
<span><span class="va">path</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">target_dir</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"mc_data_%s.pdf"</span>, <span class="va">name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">kwb.utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kwb.utils/man/catAndRun.html" class="external-link">catAndRun</a></span><span class="op">(</span>messageText <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Writting '%s' to '%s'"</span>, </span>
<span>                                           <span class="va">name</span>, </span>
<span>                                           <span class="va">path</span><span class="op">)</span>,</span>
<span>                     expr <span class="op">=</span> <span class="op">{</span></span>
<span>                       <span class="fu">kwb.utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kwb.utils/man/preparePdf.html" class="external-link">preparePdf</a></span><span class="op">(</span><span class="va">path</span>, </span>
<span>                                             width.cm <span class="op">=</span> <span class="fl">25</span>, </span>
<span>                                             height.cm <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">plts</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span>                       <span class="va">path</span> </span>
<span>                       <span class="op">}</span>, </span>
<span>                     dbg <span class="op">=</span> <span class="va">debug</span><span class="op">)</span></span>
<span> <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">pdf_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">plot_to_pdf</span><span class="op">(</span><span class="va">mc_data</span>, </span>
<span>                           <span class="st">"Leitfaehigkeit"</span>, </span>
<span>                           target_dir <span class="op">=</span> <span class="va">paths</span><span class="op">$</span><span class="va">export_dir</span><span class="op">)</span>, </span>
<span>               <span class="fu">plot_to_pdf</span><span class="op">(</span><span class="va">mc_data</span>, </span>
<span>                           <span class="st">"Temperatur"</span>, </span>
<span>                           target_dir <span class="op">=</span> <span class="va">paths</span><span class="op">$</span><span class="va">export_dir</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Writting 'Leitfaehigkeit_K10' to 'C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_data_Leitfaehigkeit_K10.pdf' ...</span></span>
<span><span class="co">#&gt; ok. (0.96s) </span></span>
<span><span class="co">#&gt; Writting 'Leitfaehigkeit_K13' to 'C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_data_Leitfaehigkeit_K13.pdf' ...</span></span>
<span><span class="co">#&gt; ok. (0.67s) </span></span>
<span><span class="co">#&gt; Writting 'Leitfaehigkeit_K09' to 'C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_data_Leitfaehigkeit_K09.pdf' ...</span></span>
<span><span class="co">#&gt; ok. (0.54s) </span></span>
<span><span class="co">#&gt; Writting 'Temperatur_K10' to 'C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_data_Temperatur_K10.pdf' ...</span></span>
<span><span class="co">#&gt; ok. (0.94s) </span></span>
<span><span class="co">#&gt; Writting 'Temperatur_K13' to 'C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_data_Temperatur_K13.pdf' ...</span></span>
<span><span class="co">#&gt; ok. (0.50s) </span></span>
<span><span class="co">#&gt; Writting 'Temperatur_K09' to 'C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_data_Temperatur_K09.pdf' ...</span></span>
<span><span class="co">#&gt; ok. (0.54s)</span></span>
<span></span>
<span><span class="va">data_zip_path</span></span>
<span><span class="co">#&gt; [1] "C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_data.zip"</span></span></code></pre></div>
<p>The file size of the
mc_data_20220927-110000TZ+01_20221205-230000TZ+01.csv file is 17.8 times
larger compared to compressing it into mc_data.zip.</p>
</div>
<div class="section level3">
<h3 id="data-upload">Data Upload<a class="anchor" aria-label="anchor" href="#data-upload"></a>
</h3>
<p>In order to automate the data management process the <a href="#data-export">exported data</a> these data will be uploaded to a
restricted shared folder on the KWB cloud. For doing so the following
environment variables need to be defined in case the code below should
be run from a client computer. However, as these variables are defined
in a GitHub actions workflow there is no need to do this locally.</p>
<pre><code><span><span class="va">NEXTCLOUD_URL</span> <span class="op">=</span> <span class="st">"https://&lt;replace-with-kwb-cloud-url&gt;"</span></span>
<span><span class="va">NEXTCLOUD_USER</span> <span class="op">=</span> <span class="st">"&lt;your-kwb-cloud-username&gt;"</span> <span class="co"># your username</span></span>
<span><span class="va">NEXTCLOUD_PASSWORD</span> <span class="op">=</span> <span class="st">"your-nextcloud-app-password"</span> <span class="co">### see details below</span></span></code></pre>
<p>Subsequently the following code is run for uploading the data:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Upload all files in "paths$export_dir"</span></span>
<span><span class="co">#upload_files &lt;- list.files(paths$export_dir, full.names = TRUE)</span></span>
<span></span>
<span></span>
<span><span class="co"># List paths of files to upload explicitly</span></span>
<span><span class="va">upload_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">stats_path</span>, </span>
<span>                  <span class="va">pdf_files</span>,</span>
<span>                  <span class="va">metadata_path</span>, </span>
<span>                  <span class="va">files_path</span>,</span>
<span>                  <span class="va">data_zip_path</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">upload_files</span>, <span class="kw">function</span><span class="op">(</span><span class="va">upload_file</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">kwb.utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kwb.utils/man/catAndRun.html" class="external-link">catAndRun</a></span><span class="op">(</span>messageText <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Uploading file %s"</span>, <span class="va">upload_file</span><span class="op">)</span>,</span>
<span>                       expr <span class="op">=</span> <span class="op">{</span></span>
<span>                       <span class="fu">kwb.nextcloud</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kwb.nextcloud/man/upload_file.html" class="external-link">upload_file</a></span><span class="op">(</span>file <span class="op">=</span> <span class="va">upload_file</span>,</span>
<span>                                                  target_path <span class="op">=</span> <span class="va">paths</span><span class="op">$</span><span class="va">upload_dir</span><span class="op">)</span></span>
<span>                       <span class="op">}</span>,</span>
<span>                       dbg <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; Uploading file C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_data_stats.csv ...</span></span>
<span><span class="co">#&gt; Listing projects/GeoSalz/Monitoring/messketten</span></span>
<span><span class="co">#&gt; Uploading</span></span>
<span><span class="co">#&gt;   C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_data_stats.csv</span></span>
<span><span class="co">#&gt; to</span></span>
<span><span class="co">#&gt;   projects/GeoSalz/Monitoring/messketten ... ok. (1.36s) </span></span>
<span><span class="co">#&gt; ok. (2.83s) </span></span>
<span><span class="co">#&gt; Uploading file C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_data_Leitfaehigkeit_K10.pdf ...</span></span>
<span><span class="co">#&gt; Listing projects/GeoSalz/Monitoring/messketten</span></span>
<span><span class="co">#&gt; Uploading</span></span>
<span><span class="co">#&gt;   C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_data_Leitfaehigkeit_K10.pdf</span></span>
<span><span class="co">#&gt; to</span></span>
<span><span class="co">#&gt;   projects/GeoSalz/Monitoring/messketten ... ok. (2.10s) </span></span>
<span><span class="co">#&gt; ok. (2.52s) </span></span>
<span><span class="co">#&gt; Uploading file C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_data_Leitfaehigkeit_K13.pdf ...</span></span>
<span><span class="co">#&gt; Listing projects/GeoSalz/Monitoring/messketten</span></span>
<span><span class="co">#&gt; Uploading</span></span>
<span><span class="co">#&gt;   C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_data_Leitfaehigkeit_K13.pdf</span></span>
<span><span class="co">#&gt; to</span></span>
<span><span class="co">#&gt;   projects/GeoSalz/Monitoring/messketten ... ok. (1.36s) </span></span>
<span><span class="co">#&gt; ok. (1.82s) </span></span>
<span><span class="co">#&gt; Uploading file C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_data_Leitfaehigkeit_K09.pdf ...</span></span>
<span><span class="co">#&gt; Listing projects/GeoSalz/Monitoring/messketten</span></span>
<span><span class="co">#&gt; Uploading</span></span>
<span><span class="co">#&gt;   C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_data_Leitfaehigkeit_K09.pdf</span></span>
<span><span class="co">#&gt; to</span></span>
<span><span class="co">#&gt;   projects/GeoSalz/Monitoring/messketten ... ok. (1.22s) </span></span>
<span><span class="co">#&gt; ok. (1.67s) </span></span>
<span><span class="co">#&gt; Uploading file C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_data_Temperatur_K10.pdf ...</span></span>
<span><span class="co">#&gt; Listing projects/GeoSalz/Monitoring/messketten</span></span>
<span><span class="co">#&gt; Uploading</span></span>
<span><span class="co">#&gt;   C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_data_Temperatur_K10.pdf</span></span>
<span><span class="co">#&gt; to</span></span>
<span><span class="co">#&gt;   projects/GeoSalz/Monitoring/messketten ... ok. (1.71s) </span></span>
<span><span class="co">#&gt; ok. (2.15s) </span></span>
<span><span class="co">#&gt; Uploading file C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_data_Temperatur_K13.pdf ...</span></span>
<span><span class="co">#&gt; Listing projects/GeoSalz/Monitoring/messketten</span></span>
<span><span class="co">#&gt; Uploading</span></span>
<span><span class="co">#&gt;   C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_data_Temperatur_K13.pdf</span></span>
<span><span class="co">#&gt; to</span></span>
<span><span class="co">#&gt;   projects/GeoSalz/Monitoring/messketten ... ok. (1.25s) </span></span>
<span><span class="co">#&gt; ok. (1.67s) </span></span>
<span><span class="co">#&gt; Uploading file C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_data_Temperatur_K09.pdf ...</span></span>
<span><span class="co">#&gt; Listing projects/GeoSalz/Monitoring/messketten</span></span>
<span><span class="co">#&gt; Uploading</span></span>
<span><span class="co">#&gt;   C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_data_Temperatur_K09.pdf</span></span>
<span><span class="co">#&gt; to</span></span>
<span><span class="co">#&gt;   projects/GeoSalz/Monitoring/messketten ... ok. (1.18s) </span></span>
<span><span class="co">#&gt; ok. (1.59s) </span></span>
<span><span class="co">#&gt; Uploading file C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_metadata.csv ...</span></span>
<span><span class="co">#&gt; Listing projects/GeoSalz/Monitoring/messketten</span></span>
<span><span class="co">#&gt; Uploading</span></span>
<span><span class="co">#&gt;   C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_metadata.csv</span></span>
<span><span class="co">#&gt; to</span></span>
<span><span class="co">#&gt;   projects/GeoSalz/Monitoring/messketten ... ok. (1.19s) </span></span>
<span><span class="co">#&gt; ok. (1.63s) </span></span>
<span><span class="co">#&gt; Uploading file C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_files.csv ...</span></span>
<span><span class="co">#&gt; Listing projects/GeoSalz/Monitoring/messketten</span></span>
<span><span class="co">#&gt; Uploading</span></span>
<span><span class="co">#&gt;   C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_files.csv</span></span>
<span><span class="co">#&gt; to</span></span>
<span><span class="co">#&gt;   projects/GeoSalz/Monitoring/messketten ... ok. (1.80s) </span></span>
<span><span class="co">#&gt; ok. (2.24s) </span></span>
<span><span class="co">#&gt; Uploading file C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_data.zip ...</span></span>
<span><span class="co">#&gt; Listing projects/GeoSalz/Monitoring/messketten</span></span>
<span><span class="co">#&gt; Uploading</span></span>
<span><span class="co">#&gt;   C:/Users/RUNNER~1/AppData/Local/Temp/RtmpsTDWSH/export/mc_data.zip</span></span>
<span><span class="co">#&gt; to</span></span>
<span><span class="co">#&gt;   projects/GeoSalz/Monitoring/messketten ... ok. (1.27s) </span></span>
<span><span class="co">#&gt; ok. (1.67s)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://mrustl.de" class="external-link">Michael Rustler</a>, <a href="https://www.kompetenz-wasser.de/en/forschung/projekte/geosalz" class="external-link"><img src="https://www.kompetenz-wasser.de/media/pages/forschung/projekte/geosalz/7bc1cad2b3-1650461797/geosalz_logo_transparent_rgb.png" alt="Project GeoSalz" height="24"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
